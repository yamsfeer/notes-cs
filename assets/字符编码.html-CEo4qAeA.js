import{_ as p}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as o,o as c,c as l,a as n,d as t,e as s,b as e}from"./app-BzW9chhs.js";const i={},d=e(`<h1 id="字符编码" tabindex="-1"><a class="header-anchor" href="#字符编码"><span>字符编码</span></a></h1><p>计算机中只有<code>0</code>和<code> 1</code>，但是人类世界有多种语言文字，它们是怎么被编码存入计算机中就是本文要介绍的问题。</p><p>在这之前，需要先强调一个公式：</p><div class="language-c" data-ext="c" data-title="c"><pre class="language-c"><code><span class="token number">8</span> bits <span class="token operator">=</span> <span class="token number">1</span> 字节
</code></pre></div><h2 id="ascii" tabindex="-1"><a class="header-anchor" href="#ascii"><span>ASCII</span></a></h2><p>ASCII（American Standard Code for Information Interchange，美国信息互换标准代码）是基于拉丁字母的一套电脑编码系统。它主要用于显示现代英语和其他西欧语言。</p>`,6),r=n("p",null,[t("这套编码系统，用一个字节中的后7位，规定了一共128个字符的编码（"),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("msup",null,[n("mn",null,"2"),n("mn",null,"7")]),n("mo",null,"="),n("mn",null,"128")]),n("annotation",{encoding:"application/x-tex"},"2 ^ 7 = 128")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.8141em"}}),n("span",{class:"mord"},[n("span",{class:"mord"},"2"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.8141em"}},[n("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},"7")])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.6444em"}}),n("span",{class:"mord"},"128")])])]),t("），最高位闲置。")],-1),u=e("<p>其中包括：</p><ul><li>33个控制字符，比如换行、换页、删除等字符</li><li>95个可显示字符，比如数字、英文字母A-Z、a-z和其他标点符号等。</li></ul><p>ASCII对照表截取（控制字符）：</p><table><thead><tr><th>二进制</th><th>十进制</th><th>十六进制</th><th>缩写</th><th>可以显示的表示法</th><th>名称/意义</th></tr></thead><tbody><tr><td>0000 1001</td><td>9</td><td>09</td><td>HT</td><td>␉</td><td>水平定位符号</td></tr><tr><td>0000 1010</td><td>10</td><td>0A</td><td>LF</td><td>␊</td><td>换行键</td></tr><tr><td>0000 1011</td><td>11</td><td>0B</td><td>VT</td><td>␋</td><td>垂直定位符号</td></tr><tr><td>0000 1100</td><td>12</td><td>0C</td><td>FF</td><td>␌</td><td>换页键</td></tr></tbody></table><p>ASCII对照表截取（可显示字符）：</p><table><thead><tr><th>二进制</th><th>十进制</th><th>十六进制</th><th>图形</th></tr></thead><tbody><tr><td>0010 0011</td><td>35</td><td>23</td><td>#</td></tr><tr><td>0010 0100</td><td>36</td><td>24</td><td>$</td></tr><tr><td>0011 0000</td><td>48</td><td>30</td><td>0</td></tr><tr><td>0011 0001</td><td>49</td><td>31</td><td>1</td></tr><tr><td>0100 0001</td><td>65</td><td>41</td><td>A</td></tr><tr><td>0100 0010</td><td>66</td><td>42</td><td>B</td></tr></tbody></table>",6),k={href:"http://ascii.911cha.com/",target:"_blank",rel:"noopener noreferrer"},g=n("h3",{id:"eascii",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#eascii"},[n("span",null,"EASCII")])],-1),x={href:"http://ascii.911cha.com/eascii.html",target:"_blank",rel:"noopener noreferrer"},h=n("p",null,"EASCII码比ASCII码扩充出来的符号包括表格符号、计算符号、希腊字母和特殊的拉丁符号。",-1),m=n("p",null,[t("但是，这仍不能解决问题。以汉语为例，常用汉字就有数千个，而8位最多只能规定256个字符的编码。也许我们可以用两个字节来编码汉字，那么就能编码 "),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("msup",null,[n("mn",null,"2"),n("mn",null,"16")]),n("mo",null,"="),n("mn",null,"65536")]),n("annotation",{encoding:"application/x-tex"},"2^{16} = 65536")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.8141em"}}),n("span",{class:"mord"},[n("span",{class:"mord"},"2"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.8141em"}},[n("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mtight"},[n("span",{class:"mord mtight"},"16")])])])])])])])]),n("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),n("span",{class:"mrel"},"="),n("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.6444em"}}),n("span",{class:"mord"},"65536")])])]),t(" 个字符。这还有问题没解决：")],-1),y=e('<ul><li>汉字总数不只65536个（据资料，汉字总数超8万）</li><li>如果在一份文本中，既出现汉字，又出现其他国家的文字，那么编码就会出问题</li><li>如果有多种编码方式，那么在解码时方式不对，文件会乱码</li></ul><p>所以，人们需要一种可以将所有字符都纳入其中的统一编码方式，于是就有了Unicode。</p><h2 id="unicode" tabindex="-1"><a class="header-anchor" href="#unicode"><span>Unicode</span></a></h2><p>Unicode在编码上和(E)ASCII是兼容的，比如ASCII中<code>A</code>字符的编码是0x41，Unicode中是<code>U+0041</code>。除此之外，Unicode还含括了大量的符号，其中<code>U+4E00 ~ U+9FFF</code>编码的是<code>中日韩统一表意文字</code>。</p>',4),b={href:"https://unicode.yunser.com/unicode",target:"_blank",rel:"noopener noreferrer"},f=n("p",null,"需要注意的是，Unicode 只是一个符号集，它只规定了符号的二进制代码，却没有规定这个二进制代码应该如何存储。",-1),w=n("p",null,[t("比如汉字“文”的Unicode编码是"),n("code",null,"U+6587"),t("，用二进制表示就是"),n("code",null,"0110 0101 1000 0111"),t("，这需要两个字节来存储，对于编码值更大的字符，就需要更多个字节。")],-1),v=n("p",null,"即使对于所有Unicode中的字符，都用两个字节来存储，那么对于英文等字符来说，必然会有大量的位没有利用，造成空间浪费。",-1),_=n("p",null,"为此，我们需要更加节省空间的方式，UTF-8就是其中一种。",-1),A=n("h2",{id:"utf-8",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#utf-8"},[n("span",null,"UTF-8")])],-1),C={href:"http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html",target:"_blank",rel:"noopener noreferrer"},I=e(`<p>UTF-8 就是在互联网上使用最广的一种 Unicode 的实现方式。其他实现方式还包括 UTF-16（字符用两个字节或四个字节表示）和 UTF-32（字符用四个字节表示），不过在互联网上基本不用。</p><p><strong>重复一遍，这里的关系是，UTF-8 是 Unicode 的实现方式之一。</strong></p><p>UTF-8 最大的一个特点，就是它是一种变长的编码方式。它可以使用1~4个字节表示一个符号，根据不同的符号而变化字节长度。</p><p>UTF-8 的编码规则很简单，只有二条：</p><ol><li>对于单字节的符号，字节的第一位设为<code>0</code>，后面7位为这个符号的 Unicode 码。因此对于英语字母，UTF-8 编码和 ASCII 码是相同的。</li><li>对于<code>n</code>字节的符号（<code>n &gt; 1</code>），第一个字节的前<code>n</code>位都设为<code>1</code>，第<code>n + 1</code>位设为<code>0</code>，后面字节的前两位一律设为<code>10</code>。剩下的没有提及的二进制位，全部为这个符号的 Unicode 码。</li></ol><p>下表总结了编码规则，字母<code>x</code>表示可用编码的位。</p><div class="language-text" data-ext="text" data-title="text"><pre class="language-text"><code>Unicode符号范围      |        UTF-8编码方式
--------------------+---------------------------------------------
0000 0000-0000 007F | 0xxxxxxx
0000 0080-0000 07FF | 110xxxxx 10xxxxxx
0000 0800-0000 FFFF | 1110xxxx 10xxxxxx 10xxxxxx
0001 0000-0010 FFFF | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx
</code></pre></div><p>跟据上表，解读 UTF-8 编码非常简单。</p><ol><li>如果一个字节的第一位是<code>0</code>，则这个字节单独就是一个字符</li><li>如果第一位是<code>1</code>，则连续有多少个<code>1</code>，就表示当前字符占用多少个字节。</li></ol><p><code>严</code>的 Unicode 是<code>4E25</code>（<code>100111000100101</code>），根据上表，可以发现<code>4E25</code>处在第三行的范围内（<code>0000 0800 - 0000 FFFF</code>），因此<code>严</code>的 UTF-8 编码需要三个字节，即格式是<code>1110xxxx 10xxxxxx 10xxxxxx</code>。然后，从<code>严</code>的最后一个二进制位开始，依次从后向前填入格式中的<code>x</code>，多出的位补<code>0</code>。这样就得到了，<code>严</code>的 UTF-8 编码是<code>11100100 10111000 10100101</code>，转换成十六进制就是<code>E4B8A5</code>。</p><h3 id="unicode-与-utf-8-之间的转换" tabindex="-1"><a class="header-anchor" href="#unicode-与-utf-8-之间的转换"><span>Unicode 与 UTF-8 之间的转换</span></a></h3><div class="language-javascript" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 判断需要多少个字节存储</span>
<span class="token keyword">function</span> <span class="token function">getCodeBytes</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> codeSeg <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x007f</span><span class="token punctuation">,</span> <span class="token number">0x07ff</span><span class="token punctuation">,</span> <span class="token number">0xffff</span><span class="token punctuation">,</span> <span class="token number">0x10ffff</span><span class="token punctuation">]</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">&gt;</span> codeSeg<span class="token punctuation">[</span>codeSeg<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;超出编码范围&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> codeSeg<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">&lt;=</span> codeSeg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">padEncodeStr</span><span class="token punctuation">(</span><span class="token parameter">binCode<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  binCode <span class="token operator">=</span> binCode<span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span>n <span class="token operator">*</span> <span class="token number">8</span> <span class="token operator">-</span> <span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">)</span> <span class="token comment">// 补齐空位</span>
  <span class="token keyword">let</span> encodeStr <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
  <span class="token keyword">let</span> binPtr <span class="token operator">=</span> binCode<span class="token punctuation">.</span>length
  <span class="token keyword">let</span> i <span class="token operator">=</span> n
  <span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token operator">--</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 首字节另外填充</span>
    encodeStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">10</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>binCode<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>binPtr <span class="token operator">-</span> <span class="token number">6</span><span class="token punctuation">,</span> binPtr<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>encodeStr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span> <span class="token comment">//截取六位填充一个字节</span>
    binPtr <span class="token operator">-=</span> <span class="token number">6</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 当只有一个字节时，以0开头</span>
  <span class="token keyword">let</span> start <span class="token operator">=</span> n <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token string">&#39;&#39;</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">0</span><span class="token template-punctuation string">\`</span></span> <span class="token operator">:</span> <span class="token string">&#39;0&#39;</span>
  encodeStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>start<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>binCode<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> binPtr<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>encodeStr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span>
  <span class="token keyword">return</span> encodeStr
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">encode</span><span class="token punctuation">(</span><span class="token parameter">char</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> code <span class="token operator">=</span> char<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> binCode <span class="token operator">=</span> code<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// 2进制字符串</span>
  <span class="token keyword">let</span> bytes <span class="token operator">=</span> <span class="token function">getCodeBytes</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span> <span class="token comment">// 需要bytes个字节存储</span>
  <span class="token keyword">return</span> <span class="token function">padEncodeStr</span><span class="token punctuation">(</span>binCode<span class="token punctuation">,</span> bytes<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-javascript" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">sliceCode</span><span class="token punctuation">(</span><span class="token parameter">binCode<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> segs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>n<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    segs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>binCode<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span>
    p <span class="token operator">+=</span> <span class="token number">8</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> segs<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token parameter">binCode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> unicode <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
  <span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">let</span> n <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>binCode<span class="token punctuation">[</span>p<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    n<span class="token operator">++</span>
  <span class="token punctuation">}</span>
  n <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token comment">// 至少需要1个字节</span>
  unicode <span class="token operator">+=</span> binCode<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
  unicode <span class="token operator">+=</span> <span class="token function">sliceCode</span><span class="token punctuation">(</span>binCode<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">0b</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>unicode<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-javascript" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">&#39;文&#39;</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&#39;111001101001011010000111&#39;</span>
<span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&#39;01100001&#39;</span>

<span class="token function">decode</span><span class="token punctuation">(</span><span class="token string">&#39;111001101001011010000111&#39;</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&#39;文&#39;</span>
<span class="token function">decode</span><span class="token punctuation">(</span><span class="token string">&#39;01100001&#39;</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&#39;a&#39;</span>

<span class="token function">decode</span><span class="token punctuation">(</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">&#39;文&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&#39;文&#39;</span><span class="token punctuation">)</span>
<span class="token function">decode</span><span class="token punctuation">(</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">&#39;0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&#39;0&#39;</span>
</code></pre></div><h2 id="base64编码" tabindex="-1"><a class="header-anchor" href="#base64编码"><span>base64编码</span></a></h2><h3 id="什么是base64" tabindex="-1"><a class="header-anchor" href="#什么是base64"><span>什么是base64</span></a></h3><p>base64的意思是用64个基本字符来编码任意数据。同理有base32、base16编码。</p><p>64个字符包括<code>A-Z</code>、<code>a-z</code>、<code>0-9</code>、<code>+/</code>。</p><p>以下是base64的编码字符对照表：</p><table><thead><tr><th style="text-align:center;">索引</th><th style="text-align:center;">字符</th><th style="text-align:center;"></th><th style="text-align:center;"></th><th style="text-align:center;"></th><th style="text-align:center;"></th><th style="text-align:center;"></th><th style="text-align:center;"></th><th style="text-align:center;"></th><th style="text-align:center;"></th><th style="text-align:center;"></th><th style="text-align:center;"></th><th style="text-align:center;"></th><th style="text-align:center;"></th><th style="text-align:center;"></th><th style="text-align:center;"></th></tr></thead><tbody><tr><td style="text-align:center;">0</td><td style="text-align:center;">A</td><td style="text-align:center;">8</td><td style="text-align:center;">I</td><td style="text-align:center;">16</td><td style="text-align:center;">Q</td><td style="text-align:center;">24</td><td style="text-align:center;">Y</td><td style="text-align:center;">32</td><td style="text-align:center;">g</td><td style="text-align:center;">40</td><td style="text-align:center;">o</td><td style="text-align:center;">48</td><td style="text-align:center;">w</td><td style="text-align:center;">56</td><td style="text-align:center;">4</td></tr><tr><td style="text-align:center;">1</td><td style="text-align:center;">B</td><td style="text-align:center;">9</td><td style="text-align:center;">J</td><td style="text-align:center;">17</td><td style="text-align:center;">R</td><td style="text-align:center;">25</td><td style="text-align:center;">Z</td><td style="text-align:center;">33</td><td style="text-align:center;">h</td><td style="text-align:center;">41</td><td style="text-align:center;">p</td><td style="text-align:center;">49</td><td style="text-align:center;">x</td><td style="text-align:center;">57</td><td style="text-align:center;">5</td></tr><tr><td style="text-align:center;">2</td><td style="text-align:center;">C</td><td style="text-align:center;">10</td><td style="text-align:center;">K</td><td style="text-align:center;">18</td><td style="text-align:center;">S</td><td style="text-align:center;">26</td><td style="text-align:center;">a</td><td style="text-align:center;">34</td><td style="text-align:center;">i</td><td style="text-align:center;">42</td><td style="text-align:center;">q</td><td style="text-align:center;">50</td><td style="text-align:center;">y</td><td style="text-align:center;">58</td><td style="text-align:center;">6</td></tr><tr><td style="text-align:center;">3</td><td style="text-align:center;">D</td><td style="text-align:center;">11</td><td style="text-align:center;">L</td><td style="text-align:center;">19</td><td style="text-align:center;">T</td><td style="text-align:center;">27</td><td style="text-align:center;">b</td><td style="text-align:center;">35</td><td style="text-align:center;">j</td><td style="text-align:center;">43</td><td style="text-align:center;">r</td><td style="text-align:center;">51</td><td style="text-align:center;">z</td><td style="text-align:center;">59</td><td style="text-align:center;">7</td></tr><tr><td style="text-align:center;">4</td><td style="text-align:center;">E</td><td style="text-align:center;">12</td><td style="text-align:center;">M</td><td style="text-align:center;">20</td><td style="text-align:center;">U</td><td style="text-align:center;">28</td><td style="text-align:center;">c</td><td style="text-align:center;">36</td><td style="text-align:center;">k</td><td style="text-align:center;">44</td><td style="text-align:center;">s</td><td style="text-align:center;">52</td><td style="text-align:center;">0</td><td style="text-align:center;">60</td><td style="text-align:center;">8</td></tr><tr><td style="text-align:center;">5</td><td style="text-align:center;">F</td><td style="text-align:center;">13</td><td style="text-align:center;">N</td><td style="text-align:center;">21</td><td style="text-align:center;">V</td><td style="text-align:center;">29</td><td style="text-align:center;">d</td><td style="text-align:center;">37</td><td style="text-align:center;">l</td><td style="text-align:center;">45</td><td style="text-align:center;">t</td><td style="text-align:center;">53</td><td style="text-align:center;">1</td><td style="text-align:center;">61</td><td style="text-align:center;">9</td></tr><tr><td style="text-align:center;">6</td><td style="text-align:center;">G</td><td style="text-align:center;">14</td><td style="text-align:center;">O</td><td style="text-align:center;">22</td><td style="text-align:center;">W</td><td style="text-align:center;">30</td><td style="text-align:center;">e</td><td style="text-align:center;">38</td><td style="text-align:center;">m</td><td style="text-align:center;">46</td><td style="text-align:center;">u</td><td style="text-align:center;">54</td><td style="text-align:center;">2</td><td style="text-align:center;">62</td><td style="text-align:center;">+</td></tr><tr><td style="text-align:center;">7</td><td style="text-align:center;">H</td><td style="text-align:center;">15</td><td style="text-align:center;">P</td><td style="text-align:center;">23</td><td style="text-align:center;">X</td><td style="text-align:center;">31</td><td style="text-align:center;">f</td><td style="text-align:center;">39</td><td style="text-align:center;">n</td><td style="text-align:center;">47</td><td style="text-align:center;">v</td><td style="text-align:center;">55</td><td style="text-align:center;">3</td><td style="text-align:center;">63</td><td style="text-align:center;">/</td></tr></tbody></table><h3 id="编码方法" tabindex="-1"><a class="header-anchor" href="#编码方法"><span>编码方法</span></a></h3><p><strong>base64编码本质上是一种将二进制数据转成文本数据的方案。</strong></p><p>编码步骤：</p><ol><li><p>每3字节为一组，共24位。</p></li><li><p>将24位重新分为四组，每组有6位。</p></li><li><p>在每组前面加<code>00</code>，得到32位，共4字节。</p></li><li><p>根据对照表，找到对应的编码字符。</p></li><li><p>如果不够3字节，则在后面补<code>0</code>直到能被6整除，然后填充<code>=</code></p><ol><li>如果剩余1个字节（8位），则补充4个<code>0</code>（12位），替换成base字符后再加上2个<code>=</code></li><li>如果剩余2个字节（16位），则补充2个<code>0</code>（18位），替换成base字符后再加上1个<code>=</code></li></ol></li></ol><p>以对字符串<code>cat</code>进行编码为例：</p><div class="language-text" data-ext="text" data-title="text"><pre class="language-text"><code>text     ｜       c         ｜        a        |          t      |
ASCII    ｜      99         ｜       97        ｜         116    ｜
binary   ｜ 0 1 1 0 0 0 1 1 ｜ 0 1 1 0 0 0 0 1 ｜ 0 1 1 1 0 1 0 0｜
index    ｜     24    ｜     54      ｜      5      ｜     52    ｜
base64   ｜      Y    |      2       |      F       |      0     |

cat 编码为 Y2F0
</code></pre></div><p>不够三个字节的情况：</p><div class="language-text" data-ext="text" data-title="text"><pre class="language-text"><code>text     ｜       c         ｜        a        |
ASCII    ｜      99         ｜       97        ｜
binary   ｜ 0 1 1 0 0 0 1 1 ｜ 0 1 1 0 0 0 0 1 ｜ 0 0 （补充2个0凑够6位）
index    ｜     24    ｜     54      ｜      4      ｜
base64   ｜     Y      |      2      |      E       |      =      |

ca 编码为 Y2E=
</code></pre></div><div class="language-text" data-ext="text" data-title="text"><pre class="language-text"><code>text     ｜       c         ｜
ASCII    ｜      99         ｜
binary   ｜ 0 1 1 0 0 0 1 1 ｜ 0 0 0 0 （补充4个0凑够6位）
inde     ｜     24    ｜     48      ｜
base64   ｜      Y     |      w      |      =       |      =      |

c 编码为 Yw==
</code></pre></div><p>base64将三个字节转化成四个字节，因此base64编码后的文本，会增大33%左右。</p><h3 id="编码函数" tabindex="-1"><a class="header-anchor" href="#编码函数"><span>编码函数</span></a></h3><div class="language-javascript" data-ext="js" data-title="js"><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function">btoa</span><span class="token punctuation">(</span><span class="token string">&#39;cat&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;Y2F0&quot;</span>
window<span class="token punctuation">.</span><span class="token function">atob</span><span class="token punctuation">(</span><span class="token string">&#39;Y2F0&#39;</span><span class="token punctuation">)</span><span class="token comment">// &quot;cat&quot;</span>
</code></pre></div><h3 id="使用场景" tabindex="-1"><a class="header-anchor" href="#使用场景"><span>使用场景</span></a></h3><ul><li><p>邮件附件编码</p><p>邮件系统使用的<code>SMTP协议（简单邮件传输协议）</code>是基于纯ASCII文本的。</p><p>人们为了能发送比如图片、音频这样的二进制文件作为附件，新增了<code>MIME（多用途互联网邮件扩展）标准</code>，在这个标准中，图片等文件会被编码成base64字符串。</p></li><li><p>网页内嵌小图片</p><p>将多个小图片编码成base64然后用<code>img</code>标签放入网页中可以有效减少网络请求数。</p><div class="language-javascript" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// canvas.toDataURL</span>
canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&quot;image/jpeg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;data:image/png;base64,iVBORw0...CYII=&quot;</span>

<span class="token comment">// blob &amp; FileReader</span>
</code></pre></div></li><li><p>JSON嵌入文件内容</p><p>可以将文件编码成base64字符串，然后用JSON传递。</p></li></ul><h2 id="url编码" tabindex="-1"><a class="header-anchor" href="#url编码"><span>URL编码</span></a></h2>`,35),q={href:"https://www.ruanyifeng.com/blog/2010/02/url_encoding.html",target:"_blank",rel:"noopener noreferrer"},E={href:"https://www.ietf.org/rfc/rfc1738.txt",target:"_blank",rel:"noopener noreferrer"},U=e(`<blockquote><p>&quot;...Only alphanumerics [0-9a-zA-Z], the special characters &quot;$-_.+!*&#39;(),&quot; [not including the quotes - ed], and reserved characters used for their reserved purposes may be used unencoded within a URL.&quot;</p><p>&quot;只有字母和数字[0-9a-zA-Z]、一些特殊符号&quot;$-_.+!*&#39;(),&quot;[不包括双引号]、以及某些保留字，才可以不经过编码直接用于URL。&quot;</p></blockquote><p>现实中URL的编码情况比较复杂：</p><ul><li><p><strong>网址路径的编码，用的是utf-8编码</strong></p><div class="language-text" data-ext="text" data-title="text"><pre class="language-text"><code>http://zh.wikipedia.org/wiki/春节
</code></pre></div><p>编码结果为：</p><div class="language-text" data-ext="text" data-title="text"><pre class="language-text"><code>http://zh.wikipedia.org/wiki/%E6%98%A5%E8%8A%82
</code></pre></div><p>其中&quot;春&quot;和&quot;节&quot;的utf-8编码分别是<code>E6 98 A5</code>和<code>E8 8A 82</code>，用<code>%</code>拼接起来得到编码结果。</p></li><li><p><strong>查询字符串的编码，用的是操作系统的默认编码。</strong></p><div class="language-text" data-ext="text" data-title="text"><pre class="language-text"><code>http://www.baidu.com/s?wd=春节
</code></pre></div><p>在一台使用<code>GB2312</code>作为默认编码的机器上，编码结果为：</p><div class="language-text" data-ext="text" data-title="text"><pre class="language-text"><code>http://www.baidu.com/s?wd=%B4%BA%BD%DA
</code></pre></div><p>我的机器的编码设置为：</p><div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code>$ locale
<span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;zh_CN.UTF-8&quot;</span>
<span class="token assign-left variable">LC_COLLATE</span><span class="token operator">=</span><span class="token string">&quot;zh_CN.UTF-8&quot;</span>
<span class="token punctuation">..</span>.
</code></pre></div><p>编码结果为：</p><div class="language-text" data-ext="text" data-title="text"><pre class="language-text"><code>http://www.baidu.com/s?wd=%E6%98%A5%E8%8A%82
</code></pre></div></li><li><p><strong>GET和POST方法的编码，用的是网页的编码</strong></p><p>所谓网页的编码，就是在html文件中<code>meta标签</code>设置的编码方式。</p><div class="language-html" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>此外，form表单中可以通过设置<code>accept-charset</code>属性来设置编码方式。</p><div class="language-html" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/xx.php<span class="token punctuation">&quot;</span></span> <span class="token attr-name">accept-charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li><li><p><strong>在Ajax调用中，IE总是采用GB2312编码（操作系统的默认编码），而Firefox总是采用utf-8编码。这就是我们的结论4。</strong></p></li></ul><h3 id="javascript编码相关函数" tabindex="-1"><a class="header-anchor" href="#javascript编码相关函数"><span>JavaScript编码相关函数</span></a></h3><p>从上面内容可以看出，<strong>网页内容的编码方式很不统一</strong>。为了让服务器获得统一的编码结果，需要使用Javascript先对URL编码，然后再向服务器提交，不要给浏览器插手的机会。</p><ul><li><p><strong>encodeURI</strong> / <strong>decodeURI</strong></p><p><code>encodeURI</code>除了常见的符号以外，对其他一些在网址中有特殊含义的符号，如<code>&quot;; / ? : @ &amp; = + $ , #&quot;</code>，<strong>不会进行编码</strong>。编码后，它输出符号的<strong>utf-8</strong>形式，并且在每个字节前加上%。</p><p>需要注意的是，它不对单引号<code>&#39;</code>编码。</p><div class="language-javascript" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token function">encodeURI</span><span class="token punctuation">(</span><span class="token string">&quot;https://www.baidu.com?mail=&#39;mail@qq.com&#39;&amp;name=春节&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// &quot;https://baidu.com?mail=&#39;mail@qq.com&#39;&amp;name=%E6%98%A5%E8%8A%82&quot;</span>
<span class="token comment">// 对于mail中的 单引号 和 @符号 没有编码，编码了“春节”</span>
</code></pre></div></li><li><p><strong>encodeURIComponent</strong> / <strong>decodeURIComponent</strong></p><p>与<code>encodeURI</code>的区别在于：</p><p>对<code>&quot;; / ? : @ &amp; = + $ , #&quot;</code>这些在encodeURI中不被编码的符号，在encodeURIComponent中统统<strong>会被编码</strong>。</p><div class="language-javascript" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span><span class="token string">&quot;https://www.baidu.com?mail=&#39;mail@qq.com&#39;&amp;name=春节&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// &quot;https%3A%2F%2Fwww.baidu.com%3Fmail%3D&#39;mail%40qq.com&#39;%26name%3D%E6%98%A5%E8%8A%82&quot;</span>
<span class="token comment">// 对于URL中所有的特殊符号，全部编码</span>
</code></pre></div></li><li><p>escape / unescape</p><p>不建议使用。</p></li></ul><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考"><span>参考</span></a></h2>`,7),F={href:"http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html",target:"_blank",rel:"noopener noreferrer"},S={href:"https://www.ruanyifeng.com/blog/2014/12/unicode.html",target:"_blank",rel:"noopener noreferrer"},j={href:"https://www.ruanyifeng.com/blog/2010/02/url_encoding.html",target:"_blank",rel:"noopener noreferrer"},T={href:"https://www.ruanyifeng.com/blog/2008/06/base64.html",target:"_blank",rel:"noopener noreferrer"},R={href:"https://zhuanlan.zhihu.com/p/111700349",target:"_blank",rel:"noopener noreferrer"};function B(L,z){const a=o("ExternalLinkIcon");return c(),l("div",null,[d,r,u,n("p",null,[t("完整的"),n("a",k,[t("ASCII对照表"),s(a)])]),g,n("p",null,[t("128个字符对于英语来说足够了，但是对于其他语言显然不够。于是，人们便将闲置的那个最高位也利用起来，提出了"),n("a",x,[t("EASCII码"),s(a)]),t("（extended ASCII）。")]),h,m,y,n("p",null,[t("可通过这个网站进行Unicode查询："),n("a",b,[t("Unicode查询"),s(a)])]),f,w,v,_,A,n("p",null,[n("a",C,[t("本节内容原文链接"),s(a)])]),I,n("p",null,[n("a",q,[t("本节内容原文链接"),s(a)])]),n("p",null,[t("网络标准"),n("a",E,[t("RFC 1738"),s(a)]),t("对URL中的字符做了硬性规定：")]),U,n("p",null,[n("a",F,[t("字符编码笔记：ASCII，Unicode 和 UTF-8"),s(a)])]),n("p",null,[n("a",S,[t("Unicode与JavaScript详解"),s(a)])]),n("p",null,[n("a",j,[t("关于URL编码"),s(a)])]),n("p",null,[n("a",T,[t("Base64笔记"),s(a)])]),n("p",null,[n("a",R,[t("一份简明的 Base64 原理解析"),s(a)])])])}const M=p(i,[["render",B],["__file","字符编码.html.vue"]]),D=JSON.parse('{"path":"/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E8%AF%86/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81.html","title":"字符编码","lang":"zh-CN","frontmatter":{"description":"字符编码 计算机中只有0和 1，但是人类世界有多种语言文字，它们是怎么被编码存入计算机中就是本文要介绍的问题。 在这之前，需要先强调一个公式： ASCII ASCII（American Standard Code for Information Interchange，美国信息互换标准代码）是基于拉丁字母的一套电脑编码系统。它主要用于显示现代英语和其他...","head":[["meta",{"property":"og:url","content":"https://yamsfeer.github.io/notes-cs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%80%9A%E8%AF%86/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81.html"}],["meta",{"property":"og:site_name","content":"yamsfeer"}],["meta",{"property":"og:title","content":"字符编码"}],["meta",{"property":"og:description","content":"字符编码 计算机中只有0和 1，但是人类世界有多种语言文字，它们是怎么被编码存入计算机中就是本文要介绍的问题。 在这之前，需要先强调一个公式： ASCII ASCII（American Standard Code for Information Interchange，美国信息互换标准代码）是基于拉丁字母的一套电脑编码系统。它主要用于显示现代英语和其他..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-12T15:44:18.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-12T15:44:18.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"字符编码\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-04-12T15:44:18.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"ASCII","slug":"ascii","link":"#ascii","children":[{"level":3,"title":"EASCII","slug":"eascii","link":"#eascii","children":[]}]},{"level":2,"title":"Unicode","slug":"unicode","link":"#unicode","children":[]},{"level":2,"title":"UTF-8","slug":"utf-8","link":"#utf-8","children":[{"level":3,"title":"Unicode 与 UTF-8 之间的转换","slug":"unicode-与-utf-8-之间的转换","link":"#unicode-与-utf-8-之间的转换","children":[]}]},{"level":2,"title":"base64编码","slug":"base64编码","link":"#base64编码","children":[{"level":3,"title":"什么是base64","slug":"什么是base64","link":"#什么是base64","children":[]},{"level":3,"title":"编码方法","slug":"编码方法","link":"#编码方法","children":[]},{"level":3,"title":"编码函数","slug":"编码函数","link":"#编码函数","children":[]},{"level":3,"title":"使用场景","slug":"使用场景","link":"#使用场景","children":[]}]},{"level":2,"title":"URL编码","slug":"url编码","link":"#url编码","children":[{"level":3,"title":"JavaScript编码相关函数","slug":"javascript编码相关函数","link":"#javascript编码相关函数","children":[]}]},{"level":2,"title":"参考","slug":"参考","link":"#参考","children":[]}],"git":{"createdTime":1712936658000,"updatedTime":1712936658000,"contributors":[{"name":"yamsfeer","email":"feer.yams@gmail.com","commits":1}]},"readingTime":{"minutes":10.36,"words":3108},"filePathRelative":"计算机基础/计算机通识/字符编码.md","localizedDate":"2024年4月12日","autoDesc":true}');export{M as comp,D as data};
