# 自底向上分析

前面介绍的**递归下降分析算法**和**LL(1)分析算法**都属于**自顶向下分析算法**，下面要介绍的是**自底向上分析算法**。

在自底向上分析算法中，最重要、应用最广泛的一类算法是LR分析算法。

LR分析算法也叫**移进-归约算法**，在`YACC`、`bison`等语法分析器生成器中被广泛使用。

LR分析算法中有`LR(0)`、`SLR`、`LR(1)`几种算法。

LL(1)分析算法：**从左(Left)向右读入程序，选择最左(L)推导，采用一个(1)前看符号**。

* 优点：算法运行高效

* 缺点：能分析的文法类型受限、通常需要改写文法

LR(0)分析算法：**从左(Left)向右读入程序，选择最右(R)推导，不采用（0）前看符号**。

* 优点：算法运行高效、容易实现、与LL(1)相比能分析更多文法

* 缺点：能分析的文法仍有限

## 自底向上分析的基本思想

假设有如下文法：

```
0: S -> E
1: E -> E + T
2:    | T
3: T -> T * F
4:    | F
5: F -> n
```

在自顶向下分析算法中，我们是**从文法出发**，看**文法能否推导出句子**；

而在自底向上分析算法中，我们是**从句子出发**，看**句子能否通过归约得出文法得到开始符号S**。

以句子`2 + 3 * 4`为例，它的归约过程如下：

```
2 + 3 * 4
F + 3 * 4
T + 3 * 4
E + 3 * 4
E + F * 4
E + T * 4
E + T * F
E + T
E
S
```

上述过程其实是一个最右推导的逆过程。从底往上看，在`E + T -> E + T * 4`过程中，我们选择的是最右边的`T`来做推导。

### 点记号

为了方便标记语法分析器已经读入了多少输入，可以使用一个点记号做标记。点记号左边是已经读入的，右边是剩余的输入。

上述的输入过程用点记号标记如下图：

<img src="https://raw.githubusercontent.com/yamsfeer/pic-bed/master/008i3skNgy1gts72hdg8wj606g08kglp02.jpg" style="zoom:90%;" />

### 移进-归约

有了点记号后，上述归约过程，可以总结为：

* 新建有一个栈

* 移进：每次从点记号右边将符号入栈（点记号右移）

* 归约：将栈顶上若干个符号（某产生式的右部）逆推导出左部非终结符

  比如产生式$A \to \beta_1\dots\beta_n$，如果$\beta_1\dots\beta_n$在栈顶，则弹出$\beta_n\dots\beta_1$，然后压入$A$。

从下图不难看出，点记号左侧的恰好就是栈内元素。

<img src="https://raw.githubusercontent.com/yamsfeer/pic-bed/master/008i3skNgy1gts72hdg8wj606g08kglp02.jpg" style="zoom:90%;" />

那么，**如何确定移进和归约的时机**是接下来要考虑的问题。
