# 线程

进程切换代价较大，因而产生线程。线程保留了并发的优点，又避免了进程切换代价大的问题。

线程相当于只切换指令，而不切换内存映射表。

## 线程切换

两个线程共用一个栈的话，指针会混乱，因此每个线程都有一个自己的栈。

线程的栈指针存放在 TCB 中。

线程切换时需要切换对应的栈。

注意，此时线程同属一个进程，它们对寄存器的修改是正常的，不需要保护数据。寄存器的数据恢复在进程切换时才需要进行。



## 内核级线程